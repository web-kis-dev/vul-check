/*
 * Generated by DevSecOps Assistant
 * Project: Legacy Migration to Gradle
 * Date: 2025-12-23
 */

plugins {
    id 'java'
    id 'war' // Web application support
    id 'org.owasp.dependencycheck' version '12.1.9' // Vulnerability Scanning
}

group = 'com.example.legacy'
version = '1.0.0-SNAPSHOT'

repositories {
    mavenCentral()
}

dependencies {
    // =========================================================================
    // Public Libraries (Maven Central)
    // =========================================================================

    // --- Logging ---
    implementation 'org.apache.logging.log4j:log4j-api:2.23.1'
    implementation 'org.apache.logging.log4j:log4j-core:2.23.1'
    implementation 'org.apache.logging.log4j:log4j-1.2-api:2.23.1' // Log4j 1.x Bridge
    implementation 'org.apache.logging.log4j:log4j-slf4j2-impl:2.23.1'
    implementation 'org.apache.logging.log4j:log4j-layout-template-json:2.23.1'
    implementation 'org.slf4j:slf4j-api:2.0.12'

    // --- Network / Netty (Deduplicated) ---
    // Replaced individual netty-codec, netty-transport, etc. with netty-all
    implementation 'io.netty:netty-all:4.2.9.Final'
    
    // HTTP Components
    implementation 'org.apache.httpcomponents.client5:httpclient5:5.3.1'
    implementation 'org.apache.httpcomponents.core5:httpcore5:5.2.4'
    implementation 'org.apache.httpcomponents.core5:httpcore5-h2:5.2.4'

    // --- Apache Commons ---
    implementation 'commons-codec:commons-codec:1.2'
    implementation 'commons-collections:commons-collections:3.2.2'
    implementation 'org.apache.commons:commons-collections4:4.4'
    implementation 'commons-configuration:commons-configuration:1.10'
    implementation 'commons-digester:commons-digester:2.1'
    implementation 'commons-io:commons-io:2.15.1'
    implementation 'org.apache.commons:commons-jcs3-core:3.2'
    implementation 'commons-lang:commons-lang:2.6'
    implementation 'org.apache.commons:commons-lang3:3.14.0'
    implementation 'commons-validator:commons-validator:1.8.0'

    // --- Google Libraries (Guava, etc.) ---
    implementation 'com.google.guava:guava:33.0.0-jre'
    implementation 'com.google.guava:failureaccess:1.0.1'
    implementation 'com.google.guava:listenablefuture:9999.0-empty-to-avoid-conflict-with-guava'
    implementation 'com.google.code.gson:gson:2.10.1'
    implementation 'com.google.errorprone:error_prone_annotations:2.24.1'
    implementation 'com.google.j2objc:j2objc-annotations:2.8'
    implementation 'com.google.code.findbugs:jsr305:3.0.2'
    implementation 'com.google.javascript:closure-compiler:v20231112'

    // --- Security (Bouncy Castle, ESAPI, Antisamy) ---
    // implementation 'org.bouncycastle:bcprov-jdk18on:1.77'
    implementation 'org.bouncycastle:bcprov-jdk18on:1.78.1'
    // implementation 'org.bouncycastle:bcprov-ext-jdk18on:1.77'
    implementation 'org.bouncycastle:bcprov-ext-jdk18on:1.78.1'
    // implementation 'org.bouncycastle:bcpkix-jdk18on:1.77'
    implementation 'org.bouncycastle:bcpkix-jdk18on:1.78.1'
    // implementation 'org.bouncycastle:bcutil-jdk18on:1.77'
    implementation 'org.bouncycastle:bcutil-jdk18on:1.78.1'

    implementation 'org.owasp.esapi:esapi:2.5.4.0'
    implementation 'org.owasp.antisamy:antisamy:1.7.5'

    

    // --- JSON & XML Utilities ---
    implementation 'com.jayway.jsonpath:json-path:2.9.0'
    implementation 'net.minidev:json-smart:2.5.2'
    implementation 'net.minidev:accessors-smart:2.5.0'
    implementation 'com.googlecode.json-simple:json-simple:1.1.1'
    implementation 'org.ow2.asm:asm:9.6'
    implementation 'org.apache-extras.beanshell:bsh:2.0b6'
    implementation 'org.eclipse.jdt:ecj:3.25.0'
    implementation 'org.javassist:javassist:3.30.2-GA'
    implementation 'jaxen:jaxen:1.2.0'
    implementation 'org.htmlunit:neko-htmlunit:3.11.1'
    implementation 'ognl:ognl:3.4.2'
    // implementation 'org.mozilla:rhino:1.7.14'
    implementation 'org.mozilla:rhino:1.7.14.1'
    implementation 'org.unbescape:unbescape:1.1.0.RELEASE'

    // Note: Project contained both checker-qual 3.12.0 and 3.42.0. Using newer.
    implementation 'org.checkerframework:checker-qual:3.42.0'

    // --- Graphics & XML ---
    implementation 'xml-apis:xml-apis:1.4.01'
    implementation 'xml-apis:xml-apis-ext:1.3.04'
    implementation 'org.apache.xmlgraphics:xmlgraphics-commons:2.9'
    implementation 'org.apache.xmlgraphics:batik-constants:1.17'
    implementation 'org.apache.xmlgraphics:batik-css:1.17'
    implementation 'org.apache.xmlgraphics:batik-i18n:1.17'
    implementation 'org.apache.xmlgraphics:batik-shared-resources:1.17'
    implementation 'org.apache.xmlgraphics:batik-util:1.17'

    // --- JSP / Taglibs ---
    implementation 'org.apache.taglibs:taglibs-standard-impl:1.2.5'
    implementation 'org.apache.taglibs:taglibs-standard-jstlel:1.2.5'
    implementation 'org.apache.taglibs:taglibs-standard-spec:1.2.5'

    // =========================================================================
    // Local / Private Libraries
    // These libraries were not found in Maven Central or have non-standard versions.
    // Ensure these files exist in the 'libs/' directory.
    // =========================================================================
    
    // Core & Security Solutions
    implementation files('libs/coreframe-core-5.5.5-SNAPSHOT.jar')
    implementation files('libs/CubeOneKSI.jar')
    implementation files('libs/eversafe_for_web_filter-6.31.139-patched.jar')
    implementation files('libs/PasswordEncrypt.jar')
    implementation files('libs/SDB_API_15214.jar')
    implementation files('libs/transkey-4-6-10_14_20240521.jar')
    implementation files('libs/transkey-4-6-7_16_20150530.jar')
    implementation files('libs/vestweb-3.1.1.jar')
    
    // Application Modules
    implementation files('libs/javarose_application-1.6.2.jar')
    implementation files('libs/javarose_crypto-1.6.2.jar')
    
    // Drivers
    implementation files('libs/ojdbc6.jar')

    // Libraries with Non-Standard Versions or Not Found in Central
    implementation files('libs/commons-beanutils-1.11.0.jar') // Std max is 1.9.x
    implementation files('libs/commons-fileupload-1.6.0.jar') // Std max is 1.5
    implementation files('libs/xom-1.3.9.jar')                // Std max is 1.3.7
}

// Configuration for OWASP Dependency Check
dependencyCheck {
    // Disable auto-update to avoid network errors (CISA/NVD blocking)
    autoUpdate = false 
    format = 'ALL' // HTML, XML, JSON
    outputDirectory = layout.buildDirectory.dir("reports/dependency-check")
    
    // Use local NVD data folder
    data {
        directory = "/Users/a113261/Documents/nvd_data"
    }

    nvd {
        apiKey = project.findProperty('nvd.api.key')
    }
    
    analyzers {
        assemblyEnabled = false // Optimization
        ossIndex {
            enabled = false
        }
    }
    // suppressionFile = 'config/dependency-check-suppressions.xml' // Optional: if you have suppressions
}

// Helper to ensure libs directory exists (Optional, for developer convenience)
tasks.register('ensureLibs') {
    doLast {
        file('libs').mkdirs()
        println "Ensure your local jars are in: " + file('libs').absolutePath
    }
}

// Task to copy all dependencies to 'download' folder (User Request)
tasks.register('copyDependencies', Copy) {
    from configurations.runtimeClasspath
    into layout.projectDirectory.dir("download")
    doLast {
        println "All dependencies have been copied to: download/"
    }
}
